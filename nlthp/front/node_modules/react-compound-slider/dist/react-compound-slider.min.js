!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):t["react-compound-slider"]=e(t.React)}(this,function(t){"use strict";var e="default"in t?t.default:t,n=function(){};var o=n;var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}})()&&Object.assign;var u="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function s(){}(function(t){t.exports=function(){function t(t,e,n,o,r,i){if(i!==u){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=s,n.PropTypes=n,n}()})(c={exports:{}},c.exports);var c,p=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.forEach(function(t){return t&&t.apply(void 0,n)})}},l=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},v=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},f=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},d=function(t){function n(){var e,o;l(this,n);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=o=f(this,t.call.apply(t,[this].concat(i))),o.getRailProps=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=o.props,n=e.emitMouse,r=e.emitTouch;return h({},t,{onMouseDown:p(t.onMouseDown,n),onTouchStart:p(t.onTouchStart,r)})},f(o,e)}return v(n,t),n.prototype.render=function(){var t=this.getRailProps,n=(0,this.props.children)({getRailProps:t});return n&&e.Children.only(n)},n}(t.Component),m=function(t){function n(){return l(this,n),f(this,t.apply(this,arguments))}return v(n,t),n.prototype.render=function(){var t=this.props,n=t.children,o=t.values,r=t.scale,i=t.count,a=t.emitMouse,u=t.emitTouch,s=n({ticks:(o||r.getTicks(i)).map(function(t){return{id:"$$-"+t,value:t,percent:r.getValue(t)}}),emitMouse:a,emitTouch:u});return s&&e.Children.only(s)},n}(t.Component);m.defaultProps={count:10};var y=function(t){function n(){var e,o;l(this,n);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=o=f(this,t.call.apply(t,[this].concat(i))),o.getTrackProps=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=o.props,n=e.emitMouse,r=e.emitTouch;return h({},t,{onMouseDown:p(t.onMouseDown,n),onTouchStart:p(t.onTouchStart,r)})},f(o,e)}return v(n,t),n.prototype.render=function(){for(var t=this.getTrackProps,n=this.props,o=n.children,r=n.left,i=n.right,a=n.scale,u=n.handles,s=a.getDomain(),c=[],p=0;p<u.length+1;p++){var l=u[p-1],h=u[p];0===p&&!0===r?l={id:"$",value:s[0],percent:0}:p===u.length&&!0===i&&(h={id:"$",value:s[1],percent:100}),l&&h&&c.push({id:l.id+"-"+h.id,source:l,target:h})}var v=o({tracks:c,getTrackProps:t});return v&&e.Children.only(v)},n}(t.Component);y.defaultProps={left:!0,right:!0};var g=function(t){function n(){var e,o;l(this,n);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=o=f(this,t.call.apply(t,[this].concat(i))),o.autofocus=function(t){t.target.focus()},o.getHandleProps=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.props,r=n.emitKeyboard,i=n.emitMouse,a=n.emitTouch;return h({},e,{onKeyDown:p(e.onKeyDown,function(e){return r(e,t)}),onMouseDown:p(e.onMouseDown,o.autofocus,function(e){return i(e,t)}),onTouchStart:p(e.onTouchStart,function(e){return a(e,t)})})},f(o,e)}return v(n,t),n.prototype.render=function(){var t=this.getHandleProps,n=this.props,o=(0,n.children)({handles:n.handles,getHandleProps:t});return o&&e.Children.only(o)},n}(t.Component);function M(t){return function(e,n){return e.val>n.val?t?-1:1:n.val>e.val?t?1:-1:0}}function T(t,e,n,o){var r=t.findIndex(function(t){return t.key===e});if(-1!==r){var i=t[r],a=i.key;return i.val===n?t:[].concat(t.slice(0,r),[{key:a,val:n}],t.slice(r+1)).sort(M(o))}return t}function b(t,e,n){if(!t)return[0,0];var o=t.getBoundingClientRect(),r=e?o.top:o.left,i=e?o.bottom:o.right,a=Math.abs(r-i)/n.n/2;return[r-a,i+a]}function S(t,e,n){for(var o,r=(o=(""+n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/))?Math.max(0,(o[1]?o[1].length:0)-(o[2]?+o[2]:0)):0,i=+t.toFixed(r),a=+e.toFixed(r),u=[],s=i;s<=a;)if(u.push(s),s=+(s+n).toFixed(r),u.length>1e6)throw new Error("Slider range is too large.  Increase step value.");return u}function w(t){var e=t.type,n=void 0===e?"":e,o=t.touches;return!o||o.length>1||"touchend"===n.toLowerCase()&&o.length>0}function k(t,e){return t?e.touches[0].clientY:e.touches[0].pageX}function E(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var x=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return E(e(t),n)}),{left:function(e,n,o,r){for(null==o&&(o=0),null==r&&(r=e.length);o<r;){var i=o+r>>>1;t(e[i],n)<0?o=i+1:r=i}return o},right:function(e,n,o,r){for(null==o&&(o=0),null==r&&(r=e.length);o<r;){var i=o+r>>>1;t(e[i],n)>0?r=i:o=i+1}return o}}}(E).right,P=Math.sqrt(50),D=Math.sqrt(10),O=Math.sqrt(2);function C(t,e,n){var o,r,i,a,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((o=e<t)&&(r=t,t=e,e=r),0===(a=function(t,e,n){var o=(e-t)/Math.max(0,n),r=Math.floor(Math.log(o)/Math.LN10),i=o/Math.pow(10,r);return r>=0?(i>=P?10:i>=D?5:i>=O?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(i>=P?10:i>=D?5:i>=O?2:1)}(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),i=new Array(r=Math.ceil(e-t+1));++u<r;)i[u]=(t+u)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),i=new Array(r=Math.ceil(t-e+1));++u<r;)i[u]=(t-u)/a;return o&&i.reverse(),i}var R=function(){function t(){l(this,t),this.domain=[0,1],this.range=[0,1],this.interpolator=null}return t.prototype.createInterpolator=function(t,e){var n=t[0],o=t[1],r=e[0],i=e[1];return o<n?(n=this.deinterpolateValue(o,n),r=this.interpolateValue(i,r)):(n=this.deinterpolateValue(n,o),r=this.interpolateValue(r,i)),function(t){return r(n(t))}},t.prototype.interpolateValue=function(t,e){return e-=t=+t,function(n){return t+e*n}},t.prototype.deinterpolateValue=function(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(){return e}},t.prototype.rescale=function(){return this.interpolator=null,this},t.prototype.getValue=function(t){var e=this.domain,n=this.range;return(this.interpolator||(this.interpolator=this.createInterpolator(e,n)))(+t)},t.prototype.setDomain=function(t){return this.domain=t.map(function(t){return+t}),this.rescale(),this},t.prototype.getDomain=function(){return this.domain},t.prototype.setRange=function(t){return this.range=t.map(function(t){return+t}),this},t.prototype.getTicks=function(t){var e=this.domain;return C(e[0],e[e.length-1],t||10)},t}(),V=function(){function t(){var e=this;l(this,t),this.getValue=function(t){var n=e.range,o=e.domain,r=e.n;return n[x(o,t,0,r)]},this.setDomain=function(t){return e.x0=+t[0],e.x1=+t[1],e.rescale(),e},this.setRange=function(t){return e.range=t.slice(),e.n=e.range.length-1,e},this.x0=0,this.x1=1,this.domain=[.5],this.range=[0,1],this.n=1}return t.prototype.rescale=function(){var t=this.x0,e=this.x1,n=this.n,o=-1;for(this.domain=new Array(n);++o<n;)this.domain[o]=((o+1)*e-(o-n)*t)/(n+1)},t}(),j="react-compound-slider:",L="undefined"!=typeof window&&"undefined"!=typeof document,U=function(){},A=function(t){function n(e){l(this,n);var o=f(this,t.call(this,e));return o.state={values:[]},o.slider=null,o.valueToPerc=new R,o.valueToStep=new V,o.pixelToStep=new V,o.onMouseMove=o.onMouseMove.bind(o),o.onTouchMove=o.onTouchMove.bind(o),o.submitUpdate=o.submitUpdate.bind(o),o.onMouseDown=o.onMouseDown.bind(o),o.onTouchStart=o.onTouchStart.bind(o),o.onKeyDown=o.onKeyDown.bind(o),o.onStart=o.onStart.bind(o),o.onMouseUp=o.onMouseUp.bind(o),o.onTouchEnd=o.onTouchEnd.bind(o),o}return v(n,t),n.prototype.componentWillMount=function(){var t=this.props,e=t.values,n=t.domain,o=t.step,r=t.reversed;this.updateRange(n,o,r),this.setValues(e,r)},n.prototype.componentWillReceiveProps=function(t){var e,n,o=t.domain,r=t.step,i=t.reversed,a=t.values,u=this.props;if(o[0]!==u.domain[0]||o[1]!==u.domain[1]||r!==u.step||i!==u.reversed){this.updateRange(o,r,i);var s=this.reMapValues(i,a);void 0!==a&&a!==u.values||(t.onChange(s),t.onUpdate(s))}else e=a,n=u.values,e===n||e.length===n.length&&e.reduce(function(t){return function(e,n,o){return e&&t[o]===n}}(n),!0)||this.setValues(a,i)},n.prototype.componentWillUnmount=function(){this.removeListeners()},n.prototype.removeListeners=function(){L&&(document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))},n.prototype.reMapValues=function(t,e){return this.setValues(e||this.state.values.map(function(t){return t.val}),t)},n.prototype.setValues=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments[1],r=0,i=e.map(function(e){var n=t.valueToStep.getValue(e);return e!==n&&(r+=1,o(!1,j+" Invalid value encountered. Changing "+e+" to "+n+".")),n}).map(function(t,e){return{key:"$$-"+e,val:t}}).sort(M(n)),a=i.map(function(t){return t.val});return r>0&&(this.props.onUpdate(a),this.props.onChange(a)),this.setState(function(){return{values:i}}),a},n.prototype.updateRange=function(t,e,n){var r=t[0],i=t[1],a=S(r,i,e);this.valueToStep.setRange(a).setDomain([r-e/2,i+e/2]),!0===n?(this.valueToPerc.setDomain([r,i]).setRange([100,0]),a.reverse()):this.valueToPerc.setDomain([r,i]).setRange([0,100]),this.pixelToStep.setRange(a),o(i>r,j+" Max must be greater than min (even if reversed). Max is "+i+". Min is "+r+".");o(a.length<=100001,j+" Increase step value (set to "+e+" currently). Found "+a.length.toLocaleString()+" values in range. Max is "+100001..toLocaleString()+".");var u=a.length-1;o(a[n?u:0]===r&&a[n?0:u]===i,j+" The range is incorrectly calculated. Check domain (min, max) and step values.")},n.prototype.onKeyDown=function(t,e){var n=["ArrowRight","ArrowUp"],o=["ArrowDown","ArrowLeft"],r=this.state.values,i=this.props,a=i.step,u=i.reversed,s=i.vertical,c=i.domain,p=t.key||t.keyCode;if(n.concat(o).includes(p)){if(s){var l=[o,n];n=l[0],o=l[1]}t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault();var h=r.find(function(t){return t.key===e});if(h){var v=h.val,f=v;n.includes(p)?f=function(t,e,n,o){var r;return r=o?t-e:t+e,o?Math.max(n[0],r):Math.min(n[1],r)}(v,a,c,u):o.includes(p)&&(f=function(t,e,n,o){var r;return r=o?t+e:t-e,o?Math.min(n[1],r):Math.max(n[0],r)}(v,a,c,u));var d=r.map(function(t){return t.key===e?{key:t.key,val:f}:t});this.submitUpdate(d,!0)}}},n.prototype.onMouseDown=function(t,e){this.onStart(t,e,!1)},n.prototype.onTouchStart=function(t,e){w(t)||this.onStart(t,e,!0)},n.prototype.onStart=function(t,e,n){var o=this.state.values,r=this.props.onSlideStart;t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),o.find(function(t){return t.key===e})?(this.active=e,r(o.map(function(t){return t.val}),{activeHandleID:e}),n?this.addTouchEvents():this.addMouseEvents()):(this.active=null,this.handleRailAndTrackClicks(t,n))},n.prototype.handleRailAndTrackClicks=function(t,e){var n=this.state.values,o=this.props,r=o.vertical,i=o.reversed,a=this.slider;this.pixelToStep.setDomain(b(a,r,this.pixelToStep));var u=void 0;u=e?this.pixelToStep.getValue(k(r,t)):this.pixelToStep.getValue(r?t.clientY:t.pageX);for(var s=null,c=1/0,p=0;p<n.length;p++){var l=n[p],h=l.key,v=l.val,f=Math.abs(v-u);f<c&&(s=h,c=f)}var d=T(n,s,u,i);this.submitUpdate(d,!0)},n.prototype.addMouseEvents=function(){L&&(document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp))},n.prototype.addTouchEvents=function(){L&&(document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("touchend",this.onTouchEnd))},n.prototype.onMouseMove=function(t){var e=this.state.values,n=this.props,o=n.vertical,r=n.reversed,i=this.active,a=this.slider;this.pixelToStep.setDomain(b(a,o,this.pixelToStep));var u=T(e,i,this.pixelToStep.getValue(o?t.clientY:t.pageX),r);this.submitUpdate(u)},n.prototype.onTouchMove=function(t){var e=this.state.values,n=this.props,o=n.vertical,r=n.reversed,i=this.active,a=this.slider;if(!w(t)){this.pixelToStep.setDomain(b(a,o,this.pixelToStep));var u=T(e,i,this.pixelToStep.getValue(k(o,t)),r);this.submitUpdate(u)}},n.prototype.submitUpdate=function(t,e){var n=this.props,r=n.mode,i=n.step,a=n.onUpdate,u=n.onChange,s=n.reversed,c=this.valueToStep.getValue;this.setState(function(n){var p=n.values,l=void 0;if("function"==typeof r)l=r(p,t,i,s,c),o(Array.isArray(l),"Custom mode function did not return an array.");else switch(r){case 1:l=function(t,e){return e}(0,t);break;case 2:l=function(t,e){for(var n=0;n<t.length;n++){if(t[n].key!==e[n].key)return t;if(e[n+1]&&e[n].val===e[n+1].val)return t}return e}(p,t);break;case 3:l=function t(e,n,o,r,i){for(var a=-1,u=!0,s=0;s<e.length;s++){var c=e[s],p=n[s];if(!p||p.key!==c.key)return e;p.val!==c.val&&(a=s,u=p.val-c.val>0)}if(-1===a)return e;for(var l=u?o:-o,h=0;h<n.length;h++){var v=n[h],f=n[h+1];if(f&&v.val===f.val){if(h===a){var d=f.val+l;if(i(d)===d){var m=t(n,T(n,f.key,f.val+l,r),o,r,i);return m===n?e:m}return e}var y=v.val+l;if(i(y)===y){var g=t(n,T(n,v.key,v.val+l,r),o,r,i);return g===n?e:g}return e}}return n}(p,t,i,s,c);break;default:l=t,o(!1,j+" Invalid mode value.")}return a(l.map(function(t){return t.val})),e&&u(l.map(function(t){return t.val})),{values:l}})},n.prototype.onMouseUp=function(){var t=this.state.values,e=this.props,n=e.onChange,o=e.onSlideEnd,r=this.active;this.active=null,n(t.map(function(t){return t.val})),o(t.map(function(t){return t.val}),{activeHandleID:r}),L&&(document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp))},n.prototype.onTouchEnd=function(){var t=this.state.values,e=this.props,n=e.onChange,o=e.onSlideEnd;this.active=null,n(t.map(function(t){return t.val})),o(t.map(function(t){return t.val})),L&&(document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))},n.prototype.render=function(){var t=this,n=this.state.values,o=this.props,r=o.className,i=o.rootStyle,a=n.map(function(e){var n=e.key,o=e.val;return{id:n,value:o,percent:t.valueToPerc.getValue(o)}}),u=e.Children.map(this.props.children,function(n){return n.type.name===d.name||n.type.name===m.name||n.type.name===y.name||n.type.name===g.name?e.cloneElement(n,{scale:t.valueToPerc,handles:a,emitKeyboard:t.onKeyDown,emitMouse:t.onMouseDown,emitTouch:t.onTouchStart}):n});return e.createElement("div",{style:i||{},className:r,ref:function(e){return t.slider=e}},u)},n}(t.PureComponent);return A.defaultProps={mode:1,step:.1,domain:[0,100],vertical:!1,reversed:!1,onChange:U,onUpdate:U,onSlideStart:U,onSlideEnd:U},A.Rail=d,A.Ticks=m,A.Tracks=y,A.Handles=g,A});
